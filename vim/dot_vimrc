set nocompatible

filetype on
syntax on

"-------------------------------------------------------------------------------
" Text formatting
"-------------------------------------------------------------------------------

set encoding=utf-8

set tabstop=8
set softtabstop=4
set shiftwidth=4
set expandtab

filetype indent on

set autoindent
set cindent
set cinoptions=:0,l1,g0

"-------------------------------------------------------------------------------
" UI settings
"-------------------------------------------------------------------------------

colorscheme default

set colorcolumn=

highlight ColorColumn ctermbg=darkgray

set ttyfast

"-------------------------------------------------------------------------------
" Visual cues
"-------------------------------------------------------------------------------

set hlsearch
set incsearch

set listchars=tab:>-,trail:.,precedes:<,extends:>
set nolist

let g:spacehi_tabcolor = "ctermfg=green ctermbg=black cterm=underline"
let g:spacehi_spacecolor = "ctermfg=green ctermbg=black cterm=standout"
let g:spacehi_nbspcolor = "ctermfg=white ctermbg=red cterm=none"

"-------------------------------------------------------------------------------
" Behavioural settings
"-------------------------------------------------------------------------------

set noundofile
set noswapfile
set nobackup
set nowritebackup

set spelllang=en
set spellfile=~/.vimspellfile.add
set nospell

"-------------------------------------------------------------------------------
" Clang format
"-------------------------------------------------------------------------------

function! ClangFormatOnWrite()
  let l:formatdiff = 1
  py3file ~/clang-format.py
endfunction

"-------------------------------------------------------------------------------
" Key mappings
"-------------------------------------------------------------------------------

nnoremap <F5> :set spell!<CR>
nnoremap <F6> :set list!<CR>
nnoremap <F7> :ToggleSpaceHi<CR>
nnoremap <F8> :set hlsearch!<CR>

set pastetoggle=<F9>

"-------------------------------------------------------------------------------
" Auto commands
"-------------------------------------------------------------------------------

augroup vimrc_autocmd
  autocmd!
  au BufRead,BufNewFile *.tpp setlocal filetype=cpp
  au syntax * SpaceHi
  au FileType gitcommit setlocal spell
  au BufWritePre *.h,*.hpp,*.c,*.cc,*.cpp call ClangFormatOnWrite()
augroup END
